class MenubarNavigation{constructor(t){this.domNode=t,this.menuitems=[],this.popups=[],this.menuitemGroups={},this.menuOrientation={},this.isPopup={},this.isPopout={},this.openPopups=!1,this.firstChars={},this.firstMenuitem={},this.lastMenuitem={},this.initMenu(t,0),t.addEventListener("focusin",this.onMenubarFocusin.bind(this)),t.addEventListener("focusout",this.onMenubarFocusout.bind(this)),window.addEventListener("pointerdown",this.onBackgroundPointerdown.bind(this),!0),t.querySelector("[role=menuitem]").tabIndex=0,location.href.split("#").length>1?(location.href,function(t){var e=location.href.split("#")[1];e="string"==typeof e?e.split("-").map(function(t){return t.charAt(0).toUpperCase()+t.slice(1)}).join(" "):"Home"}()):location.href+"/"}getParentMenuitem(t){var e=t.parentNode;return!!(e&&(e=e.parentNode)&&(e=e.previousElementSibling)&&"menuitem"===e.getAttribute("role"))&&e}getMenuitems(t,e){var s=[],i=this.initMenu.bind(this),n=this.popups;return function t(o){for(var u,r;o;){switch(r=!0,(u=o.getAttribute("role"))&&(u=u.trim().toLowerCase()),u){case"menu":o.tabIndex=-1,i(o,e+1),r=!1;break;case"menuitem":"true"===o.getAttribute("aria-haspopup")&&n.push(o),s.push(o)}r&&o.firstElementChild&&"svg"!==o.firstElementChild.tagName&&t(o.firstElementChild),o=o.nextElementSibling}}(t.firstElementChild),s}initMenu(t,e){var s,i,n=this.getMenuId(t);s=this.getMenuitems(t,e),this.menuOrientation[n]=this.getMenuOrientation(t),this.isPopup[n]="menu"===t.getAttribute("role")&&1===e,this.isPopout[n]="menu"===t.getAttribute("role")&&e>1,this.menuitemGroups[n]=[],this.firstChars[n]=[],this.firstMenuitem[n]=null,this.lastMenuitem[n]=null;for(var o=0;o<s.length;o++)(i=s[o]).getAttribute("role").indexOf("menuitem")<0||(i.tabIndex=-1,this.menuitems.push(i),this.menuitemGroups[n].push(i),this.firstChars[n].push(i.textContent.trim().toLowerCase()[0]),i.addEventListener("keydown",this.onKeydown.bind(this)),i.addEventListener("click",this.onMenuitemClick.bind(this),{capture:!0}),i.addEventListener("pointerover",this.onMenuitemPointerover.bind(this)),this.firstMenuitem[n]||(this.hasPopup(i)&&(i.tabIndex=0),this.firstMenuitem[n]=i),this.lastMenuitem[n]=i)}setFocusToMenuitem(t,e){this.closePopupAll(e),this.menuitemGroups[t]&&this.menuitemGroups[t].forEach(function(t){t===e?(t.tabIndex=0,e.focus()):t.tabIndex=-1})}setFocusToFirstMenuitem(t){this.setFocusToMenuitem(t,this.firstMenuitem[t])}setFocusToLastMenuitem(t){this.setFocusToMenuitem(t,this.lastMenuitem[t])}setFocusToPreviousMenuitem(t,e){var s,i;return e===this.firstMenuitem[t]?s=this.lastMenuitem[t]:(i=this.menuitemGroups[t].indexOf(e),s=this.menuitemGroups[t][i-1]),this.setFocusToMenuitem(t,s),s}setFocusToNextMenuitem(t,e){var s,i;return e===this.lastMenuitem[t]?s=this.firstMenuitem[t]:(i=this.menuitemGroups[t].indexOf(e),s=this.menuitemGroups[t][i+1]),this.setFocusToMenuitem(t,s),s}setFocusToNextMenuitemTab(t,e){var s,i;return e===this.lastMenuitem[t]?(this.openPopups=!1,this.setMenubarDataExpanded("false"),s=this.firstMenuitem[t],this.setFocusToMenuitem(t,s),this.closePopup(n)):(i=this.menuitemGroups[t].indexOf(e),s=this.menuitemGroups[t][i+1]),this.setFocusToMenuitem(t,s),s}setFocusByFirstCharacter(t,e,s){var i,n;s=s.toLowerCase(),(i=this.menuitemGroups[t].indexOf(e)+1)>=this.menuitemGroups[t].length&&(i=0),-1===(n=this.getIndexFirstChars(t,i,s))&&(n=this.getIndexFirstChars(t,0,s)),n>-1&&this.setFocusToMenuitem(t,this.menuitemGroups[t][n])}getIndexFirstChars(t,e,s){for(var i=e;i<this.firstChars[t].length;i++)if(s===this.firstChars[t][i])return i;return-1}isPrintableCharacter(t){return 1===t.length&&t.match(/\S/)}getIdFromAriaLabel(t){var e=t.getAttribute("aria-label");return e&&(e=e.trim().toLowerCase().replace(" ","-").replace("/","-")),e}getMenuOrientation(t){var e=t.getAttribute("aria-orientation");if(!e)switch(t.getAttribute("role")){case"menubar":e="horizontal";break;case"menu":e="vertical"}return e}getMenuId(t){for(var e=!1,s=t.getAttribute("role");t&&"menu"!==s&&"menubar"!==s;)(t=t.parentNode)&&(s=t.getAttribute("role"));return t&&(e=s+"-"+this.getIdFromAriaLabel(t)),e}getMenu(t){for(var e=t,s=t.getAttribute("role");e&&"menu"!==s&&"menubar"!==s;)(e=e.parentNode)&&(s=e.getAttribute("role"));return e}isAnyPopupOpen(){for(var t=0;t<this.popups.length;t++)if("true"===this.popups[t].getAttribute("aria-expanded"))return!0;return!1}setMenubarDataExpanded(t){this.domNode.setAttribute("data-menubar-item-expanded",t)}isMenubarDataExpandedTrue(){return"true"===this.domNode.getAttribute("data-menubar-item-expanded")}openPopup(t,e){var s=e.nextElementSibling;if(s){var i=e.getBoundingClientRect();return this.isPopup[t]?(s.parentNode.style.position="relative",s.style.display="block",s.style.position="absolute",s.style.left=i.width+10+"px",s.style.top="0px",s.style.zIndex=100):(s.style.display="block",s.style.position="absolute",s.style.left="0px",s.style.top=i.height+8+"px",s.style.zIndex=100),e.setAttribute("aria-expanded","true"),this.setMenubarDataExpanded("true"),this.getMenuId(s)}return!1}closePopout(t){for(var e,s=this.getMenuId(t),i=t;this.isPopup[s]||this.isPopout[s];)i=(e=this.getMenu(i)).previousElementSibling,s=this.getMenuId(i),e.style.display="none";return i.focus(),i}closePopup(t){var e,s=this.getMenuId(t),i=t;return this.isMenubar(s)?this.isOpen(t)&&(t.setAttribute("aria-expanded","false"),t.nextElementSibling.style.display="none"):((i=(e=this.getMenu(t)).previousElementSibling).setAttribute("aria-expanded","false"),i.focus(),e.style.display="none"),i}doesNotContain(t,e){return!e||!t.nextElementSibling.contains(e)}closePopupAll(t){"object"!=typeof t&&(t=!1);for(var e=0;e<this.popups.length;e++){var s=this.popups[e];if(this.doesNotContain(s,t)&&this.isOpen(s)){var i=s.nextElementSibling;i&&(s.setAttribute("aria-expanded","false"),i.style.display="none")}}}hasPopup(t){return"true"===t.getAttribute("aria-haspopup")}isOpen(t){return"true"===t.getAttribute("aria-expanded")}isMenubar(t){return!this.isPopup[t]&&!this.isPopout[t]}isMenuHorizontal(t){return"horizontal"===this.menuOrientation[t]}hasFocus(){return this.domNode.classList.contains("focus")}onMenubarFocusin(){this.domNode.classList.add("focus")}onMenubarFocusout(){this.domNode.classList.remove("focus")}onKeydown(t){var e,s,i,n=t.currentTarget,o=t.key,u=!1,r=this.getMenuId(n);switch(o){case" ":case"Enter":this.hasPopup(n)?(this.openPopups=!0,s=this.openPopup(r,n),this.setFocusToFirstMenuitem(s)):"#"!==n.href&&(this.closePopupAll(),this.updateContent(n.href,n.textContent.trim()),this.setMenubarDataExpanded("false")),u=!0;break;case"Esc":case"Escape":this.openPopups=!1,i=this.closePopup(n),e=this.getMenuId(i),this.setMenubarDataExpanded("false"),u=!0;break;case"Up":case"ArrowUp":this.isMenuHorizontal(r)?this.hasPopup(n)&&(this.openPopups=!0,s=this.openPopup(r,n),this.setFocusToLastMenuitem(s)):this.setFocusToPreviousMenuitem(r,n),u=!0;break;case"ArrowDown":case"Down":this.isMenuHorizontal(r)?this.hasPopup(n)&&(this.openPopups=!0,s=this.openPopup(r,n),this.setFocusToFirstMenuitem(s)):this.setFocusToNextMenuitem(r,n),u=!0;break;case"Left":case"ArrowLeft":this.isMenuHorizontal(r)?(i=this.setFocusToPreviousMenuitem(r,n),(this.isAnyPopupOpen()||this.isMenubarDataExpandedTrue())&&this.openPopup(r,i)):this.isPopout[r]?(i=this.closePopup(n),e=this.getMenuId(i),i=this.setFocusToMenuitem(e,i)):(i=this.closePopup(n),e=this.getMenuId(i),i=this.setFocusToPreviousMenuitem(e,i),this.openPopup(e,i)),u=!0;break;case"Right":case"ArrowRight":this.isMenuHorizontal(r)?(i=this.setFocusToNextMenuitem(r,n),(this.isAnyPopupOpen()||this.isMenubarDataExpandedTrue())&&this.openPopup(r,i)):this.hasPopup(n)?(s=this.openPopup(r,n),this.setFocusToFirstMenuitem(s)):(i=this.closePopout(n),e=this.getMenuId(i),i=this.setFocusToNextMenuitem(e,i),this.openPopup(e,i)),u=!0;break;case"Home":case"PageUp":this.setFocusToFirstMenuitem(r,n),u=!0;break;case"End":case"PageDown":this.setFocusToLastMenuitem(r,n),u=!0;break;case"Tab":this.isMenuHorizontal(r)?(i=this.setFocusToNextMenuitemTab(r,n),(this.isAnyPopupOpen()||this.isMenubarDataExpandedTrue())&&this.openPopup(r,i)):this.hasPopup(n)?(s=this.openPopup(r,n),this.setFocusToFirstMenuitem(s)):(i=this.closePopout(n),e=this.getMenuId(i),i=this.setFocusToNextMenuitemTab(e,i),this.openPopup(e,i)),u=!0;break;default:this.isPrintableCharacter(o)&&(this.setFocusByFirstCharacter(r,n,o),u=!0)}u&&(t.stopPropagation(),t.preventDefault())}onMenuitemClick(t){var e=t.currentTarget,s=this.getMenuId(e);this.hasPopup(e)?this.isOpen(e)?this.closePopup(e):(this.closePopupAll(e),this.openPopup(s,e)):this.closePopupAll()}onMenuitemPointerover(t){var e=t.currentTarget,s=this.getMenuId(e);this.hasFocus()&&this.setFocusToMenuitem(s,e),(this.isAnyPopupOpen()||this.hasFocus())&&(this.closePopupAll(e),this.hasPopup(e)&&this.openPopup(s,e))}onBackgroundPointerdown(t){this.domNode.contains(t.target)||this.closePopupAll()}}window.addEventListener("load",function(){for(var t=document.querySelectorAll(".menubar-navigation"),e=0;e<t.length;e++)new MenubarNavigation(t[e])});